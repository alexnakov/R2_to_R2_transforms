<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insert Input in MathML</title>
    <style>
        math { font-size: 400%;}
        .math-container {
            position: relative; /* Makes this container the reference point for absolute positioning */
            display: inline-block; /* Adjust as needed */
        }
        .input-overlay {
            position: absolute; /* Position relative to the nearest positioned ancestor */
            top: 0;
            left: 0;
            transform: translate(0, -50%); /* Adjust as needed to align correctly */
            z-index: 10; /* Ensure it is above other content */
        }
    </style>
</head>
<body>
    <!-- MathML Content in a container with relative positioning -->
    <div class="math-container">
        <math xmlns="http://www.w3.org/1998/Math/MathML" id="math-equation">
            <mi id="editable-mi">x</mi>
            <mo>=</mo>
            <mfrac>
                <mi>y</mi>
                <mi>z</mi>
            </mfrac>
        </math>
    </div>

    <button onclick="insertInput()">Insert Input</button>
    <button onclick="saveInput()">Save</button>

    <script>
        function insertInput() {
            // Get the <mi> element and its container
            const miElement = document.getElementById('editable-mi');
            const container = miElement.closest('.math-container');

            // Create an <input> element
            const inputElement = document.createElement('input');
            inputElement.type = 'text';
            inputElement.value = miElement.textContent;
            inputElement.className = 'input-overlay';

            // Get the position of the <mi> element
            const miRect = miElement.getBoundingClientRect();
            console.log(miRect)
            const containerRect = container.getBoundingClientRect();
            console.log(containerRect)

            // Set the position of the input element to overlay the <mi> element
            inputElement.style.left = `${miRect.left - containerRect.left}px`;
            inputElement.style.top = `${miRect.top - containerRect.top}px`;
            inputElement.style.width = `${miRect.width}px`
            inputElement.style.height = `${miRect.height}px`

            // Append the <input> element to the container
            container.appendChild(inputElement);
        }

        function saveInput() {
            // Get the <input> element
            const inputElement = document.querySelector('.input-overlay');
            
            // Get the <mi> element
            const miElement = document.getElementById('editable-mi');

            // Update the <mi> element's text content with the input value
            miElement.textContent = inputElement.value;

            // Remove the <input> element
            inputElement.remove();
        }
    </script>
</body>
</html>
